"use strict";(self.webpackChunkhacktuts=self.webpackChunkhacktuts||[]).push([[2714],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return g}});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(n),g=r,m=d["".concat(l,".").concat(g)]||d[g]||p[g]||a;return n?i.createElement(m,o(o({ref:t},u),{},{components:n})):i.createElement(m,o({ref:t},u))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var c=2;c<a;c++)o[c]=n[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6813:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return g},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return p}});var i=n(7462),r=n(3366),a=(n(7294),n(3905)),o=["components"],s={tags:["rate limiting"],title:"User rate limiting",image:"img/Portswigger/authentication.png"},l="User rate limiting",c={unversionedId:"penetration-testing/Authentication/user-rate-limiting",id:"penetration-testing/Authentication/user-rate-limiting",title:"User rate limiting",description:"Another way websites try to prevent brute-force attacks is through user rate limiting. In this case, making too many login requests within a short period of time causes your IP address to be blocked. Typically, the IP can only be unblocked in one of the following ways:",source:"@site/docs/penetration-testing/Authentication/user-rate-limiting.md",sourceDirName:"penetration-testing/Authentication",slug:"/penetration-testing/Authentication/user-rate-limiting",permalink:"/CyberSecurityTutorials/docs/penetration-testing/Authentication/user-rate-limiting",draft:!1,tags:[{label:"rate limiting",permalink:"/CyberSecurityTutorials/docs/tags/rate-limiting"}],version:"current",frontMatter:{tags:["rate limiting"],title:"User rate limiting",image:"img/Portswigger/authentication.png"},sidebar:"tutorialSidebar",previous:{title:"Stay logged in cookie",permalink:"/CyberSecurityTutorials/docs/penetration-testing/Authentication/stay-logged-in-cookie"}},u={},p=[{value:"Lab",id:"lab",level:2}],d={toc:p};function g(e){var t=e.components,s=(0,r.Z)(e,o);return(0,a.kt)("wrapper",(0,i.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"user-rate-limiting"},"User rate limiting"),(0,a.kt)("p",null,"Another way websites try to prevent brute-force attacks is through user rate limiting. In this case, making too many login requests within a short period of time causes your IP address to be blocked. Typically, the IP can only be unblocked in one of the following ways:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Automatically after a certain period of time has elapsed"),(0,a.kt)("li",{parentName:"ul"},"Manually by an administrator"),(0,a.kt)("li",{parentName:"ul"},"Manually by the user after successfully completing a CAPTCHA")),(0,a.kt)("p",null,"User rate limiting is sometimes preferred to account locking due to being less prone to username enumeration and denial of service attacks. However, it is still not completely secure. As we saw an example of in an earlier lab, there are several ways an attacker can manipulate their apparent IP in order to bypass the block."),(0,a.kt)("p",null,"As the limit is based on the rate of HTTP requests sent from the user's IP address, it is sometimes also possible to bypass this defense if you can work out how to guess multiple passwords with a single request."),(0,a.kt)("h2",{id:"lab"},"Lab"),(0,a.kt)("p",null,"I tried sample login and got this request"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'POST /login HTTP/1.1\nHost: ac301f2d1ef7e4cac0bf77da00e200d9.web-security-academy.net\nCookie: session=kSD5bTwSYSs3DWpB4WbGJB2cehDujNvV\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://ac301f2d1ef7e4cac0bf77da00e200d9.web-security-academy.net/login\nContent-Type: text/plain;charset=UTF-8\nOrigin: https://ac301f2d1ef7e4cac0bf77da00e200d9.web-security-academy.net\nContent-Length: 45\nTe: trailers\nConnection: close\n\n{"username":"carlos","password":"test","":""}\n')),(0,a.kt)("p",null,"--\x3e When i saw the source code of page, i found one file called ",(0,a.kt)("inlineCode",{parentName:"p"},"login.js")," and maybe it contains the login logic."),(0,a.kt)("p",null,"And the website is reading the passwords from a json file so we can make one array of all the possible passwords and it will check all them once in a single request."),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(3447).Z,width:"1373",height:"773"})),(0,a.kt)("p",null,"I used ",(0,a.kt)("inlineCode",{parentName:"p"},"cyberchef")," to do this"),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(3292).Z,width:"1545",height:"797"})),(0,a.kt)("p",null,"--\x3e And then i replaced the ",(0,a.kt)("inlineCode",{parentName:"p"},"passwords")," field with the array which i made!"),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(4239).Z,width:"1815",height:"819"})),(0,a.kt)("p",null,"And i solved the lab!"),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(4251).Z,width:"1285",height:"655"})))}g.isMDXComponent=!0},4239:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220203125355-18168a52c4b405dea50ce2d741b7435a.png"},3292:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220203125608-3a5aa6aeda2df50b030fe3a3978ea564.png"},3447:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220203125715-f68e1a8e229ec77cd541663a2ede6285.png"},4251:function(e,t,n){t.Z=n.p+"assets/images/Pastedimage20220203125843-98ff8732e3f564d0563535447e1d07c5.png"}}]);